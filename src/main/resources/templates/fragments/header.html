<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<header th:fragment="header">
    <div class="flex justify-between items-center pt-4 z-50 fixed top-0 left-0 w-full">
        <!-- ë¡œê³  ì˜ì—­ -->
        <div class="flex items-center ml-10">
            <a th:href="@{/}" href="index.html">
                <img src="/images/logo.png" alt="Logo" class="h-32 mr-5">
            </a>
        </div>

        <!-- ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ -->
        <nav class="flex items-center justify-between w-full mr-10">
            <ul class="flex space-x-5 ml-auto">
                <!-- ì¼ë°˜ ë©”ë‰´ í•­ëª©ë“¤ -->
                <li><a th:href="@{/information}" class="text-gray-300 hover:text-gray-400 transition duration-500">ê¸°ëŠ¥ì†Œê°œ</a></li>
                <li><a th:href="@{/crop}" class="text-gray-300 hover:text-gray-400 transition duration-500">ì‘ë¬¼ê´€ë¦¬</a></li>
                <li><a th:href="@{/weather}" class="text-gray-300 hover:text-gray-400 transition duration-500">ê¸°ìƒì •ë³´</a></li>
                <li><a th:href="@{/news}" class="text-gray-300 hover:text-gray-400 transition duration-500">ë†ì—…ì†Œì‹</a></li>
                <li><a th:href="@{/posts}" class="text-gray-300 hover:text-gray-400 transition duration-500">ì†Œí†µë§ˆë‹¹</a></li>

                <!-- ë¡œê·¸ì¸ ì—¬ë¶€ì— ë”°ë¥¸ ë©”ë‰´ í•­ëª©ë“¤ -->
                <li th:if="${not #authorization.expression('isAuthenticated()')}">
                    <a th:href="@{/member/login}" href="login.html" class="text-gray-300 hover:text-gray-400 transition duration-500">ë¡œê·¸ì¸</a>
                </li>
                <li th:if="${#authorization.expression('isAuthenticated()')}">
                    <a th:href="@{/member/profile}" href="profile.html" class="text-gray-300 hover:text-gray-400 transition duration-500">í”„ë¡œí•„</a>
                </li>
                <li th:if="${#authorization.expression('isAuthenticated()')}">
                    <a th:href="@{/member/logout}" href="logout.html" class="text-gray-300 hover:text-gray-400 transition duration-500">ë¡œê·¸ì•„ì›ƒ</a>
                </li>

                <!-- ì¶”ê°€ ë©”ë‰´ í•­ëª© -->
                <li><a th:href="@{/subscription}" class="text-gray-300 hover:text-gray-400 transition duration-500">ë©¤ë²„ì‰½ê²°ì œ</a></li>
            </ul>
        </nav>
    </div>

    <script th:if="${#authorization.expression('isAuthenticated()')}">
        const eventSource = new EventSource('/notification/connect');

        eventSource.onmessage = function(event) {
            console.log('SSE ì•Œë¦¼ ìˆ˜ì‹  : ' + event.data);
            let data;
            try {
                data = JSON.parse(event.data);
            } catch (e) {
                // JSONì´ ì•„ë‹ˆë©´ ê·¸ëƒ¥ ë¬¸ìì—´ì„ ë©”ì‹œì§€ë¡œ ì²˜ë¦¬
                data = { message: event.data };
            }
            alert('ğŸ”” ìƒˆ ì•Œë¦¼: ' + data.message);
        };

        eventSource.onerror = function() {
            console.error("SSE ì—°ê²° ì˜¤ë¥˜ ë°œìƒ");
            eventSource.close();
        };
    </script>
</header>
</html>
